webpackJsonp([4],{NsiS:function(e,t,i){t=e.exports=i("FZ+f")(!0),t.push([e.i,'#wechat .wechat-list{position:relative;overflow-x:hidden;z-index:1}#wechat .wechat-list .list-row{height:64px;position:relative;overflow:hidden}#wechat .wechat-list .list-row.item-hide{-webkit-transition:.3s;transition:.3s;height:0}#wechat .wechat-list .list-row.item-hide:after{content:"";position:absolute;z-index:2;top:1px;bottom:1px;width:100%;background:rgba(0,0,0,.3)}#wechat .wechat-list .list-row:last-child:after{content:"";position:absolute;width:200%;left:0;z-index:10;left:8px;bottom:0;-ms-transform:scale(.5);transform:scale(.5);-ms-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(.5);-webkit-transform-origin:0 0;background-color:#b7b7b7;height:1px}#wechat .wechat-list .list-row .list-info{position:relative;z-index:2;left:0;width:100%;height:64px;padding:8px;background-color:#fff}#wechat .wechat-list .list-row .list-info .header-box{position:relative;float:left;width:48px;height:48px;margin-right:10px}#wechat .wechat-list .list-row .list-info .header-box .header{height:100%;border-radius:5px;display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;overflow:hidden;background:#dddbdb}#wechat .wechat-list .list-row .list-info .header-box .header img{width:10%;height:auto;-webkit-box-flex:2;-webkit-flex-grow:2;-ms-flex-positive:2;flex-grow:2;border:0}#wechat .wechat-list .list-row .list-info .header-box .header.multi-header img{margin:1px}#wechat .wechat-list .list-row .list-info .desc-box{overflow:hidden}#wechat .wechat-list .list-row .list-info .desc-box .desc-time{float:right;color:#b8b8b8}#wechat .wechat-list .list-row .list-info .desc-box .desc-author{height:25px;line-height:25px;font-size:16px;color:#000}#wechat .wechat-list .list-row .list-info .desc-box .desc-msg{height:23px;line-height:23px;font-size:14px;color:#888}#wechat .wechat-list .list-row .list-info .desc-box .desc-msg .desc-mute{float:right;color:#b8b8b8}#wechat .wechat-list .list-row .operate-box{position:absolute;z-index:1;height:100%;right:0;top:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}#wechat .wechat-list .list-row .operate-box>div{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;background-color:#c7c7cc;color:#fff;font-size:18px;padding:0 12px}#wechat .wechat-list .list-row .operate-box .operate-del{background-color:#ff3b30}',"",{version:3,sources:["/Users/yunwisdom/Workspace/xdata-vuechat-service/src/assets/css/wechat.css"],names:[],mappings:"AAAA,qBAAqB,kBAAkB,kBAAkB,SAAS,CAAC,+BAA+B,YAAY,kBAAkB,eAAe,CAAC,yCAAyC,uBAAwB,eAAgB,QAAU,CAAC,+CAA+C,WAAW,kBAAkB,UAAU,QAAQ,WAAW,WAAW,yBAA0B,CAAC,gDAAgD,WAAW,kBAAkB,WAAW,OAAO,WAAW,SAAS,SAAS,AAA6B,wBAAyB,oBAAqB,AAA6B,yBAAyB,qBAAqB,4BAA6B,6BAA6B,yBAAyB,UAAU,CAAC,0CAA0C,kBAAkB,UAAU,OAAO,WAAW,YAAY,YAAY,qBAAqB,CAAC,sDAAsD,kBAAkB,WAAW,WAAW,YAAY,iBAAiB,CAAC,8DAA8D,YAAY,kBAAkB,oBAAoB,oBAAoB,aAAa,qBAAqB,8BAA8B,6BAA6B,2BAA2B,uBAAuB,mBAAmB,uBAAuB,mBAAmB,eAAe,wBAAwB,+BAA+B,qBAAqB,uBAAuB,gBAAgB,kBAAkB,CAAC,kEAAkE,UAAU,YAAY,mBAAmB,oBAAoB,oBAAoB,YAAY,QAAQ,CAAC,+EAA+E,UAAU,CAAC,oDAAoD,eAAe,CAAC,+DAA+D,YAAY,aAAa,CAAC,iEAAiE,YAAY,iBAAiB,eAAe,UAAU,CAAC,8DAA8D,YAAY,iBAAiB,eAAe,UAAU,CAAC,yEAAyE,YAAY,aAAa,CAAC,4CAA4C,kBAAkB,UAAU,YAAY,QAAQ,MAAM,oBAAoB,qBAAqB,oBAAoB,YAAY,CAAC,gDAAgD,oBAAoB,qBAAqB,oBAAoB,aAAa,wBAAwB,+BAA+B,qBAAqB,uBAAuB,yBAAyB,2BAA2B,sBAAsB,mBAAmB,yBAAyB,WAAW,eAAe,cAAc,CAAC,yDAAyD,wBAAwB,CAAC",file:"wechat.css",sourcesContent:['#wechat .wechat-list{position:relative;overflow-x:hidden;z-index:1}#wechat .wechat-list .list-row{height:64px;position:relative;overflow:hidden}#wechat .wechat-list .list-row.item-hide{-webkit-transition:0.3s;transition:0.3s;height:0px}#wechat .wechat-list .list-row.item-hide:after{content:"";position:absolute;z-index:2;top:1px;bottom:1px;width:100%;background:rgba(0,0,0,0.3)}#wechat .wechat-list .list-row:last-child:after{content:"";position:absolute;width:200%;left:0;z-index:10;left:8px;bottom:0;-webkit-transform:scale(0.5);-ms-transform:scale(0.5);transform:scale(0.5);-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(0.5);-webkit-transform-origin:0 0;background-color:#b7b7b7;height:1px}#wechat .wechat-list .list-row .list-info{position:relative;z-index:2;left:0;width:100%;height:64px;padding:8px;background-color:#fff}#wechat .wechat-list .list-row .list-info .header-box{position:relative;float:left;width:48px;height:48px;margin-right:10px}#wechat .wechat-list .list-row .list-info .header-box .header{height:100%;border-radius:5px;display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;overflow:hidden;background:#dddbdb}#wechat .wechat-list .list-row .list-info .header-box .header img{width:10%;height:auto;-webkit-box-flex:2;-webkit-flex-grow:2;-ms-flex-positive:2;flex-grow:2;border:0}#wechat .wechat-list .list-row .list-info .header-box .header.multi-header img{margin:1px}#wechat .wechat-list .list-row .list-info .desc-box{overflow:hidden}#wechat .wechat-list .list-row .list-info .desc-box .desc-time{float:right;color:#b8b8b8}#wechat .wechat-list .list-row .list-info .desc-box .desc-author{height:25px;line-height:25px;font-size:16px;color:#000}#wechat .wechat-list .list-row .list-info .desc-box .desc-msg{height:23px;line-height:23px;font-size:14px;color:#888}#wechat .wechat-list .list-row .list-info .desc-box .desc-msg .desc-mute{float:right;color:#b8b8b8}#wechat .wechat-list .list-row .operate-box{position:absolute;z-index:1;height:100%;right:0;top:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}#wechat .wechat-list .list-row .operate-box>div{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;background-color:#c7c7cc;color:#fff;font-size:18px;padding:0 12px}#wechat .wechat-list .list-row .operate-box .operate-del{background-color:#ff3b30}\n'],sourceRoot:""}])},"Q8/9":function(e,t,i){var s=i("VXHo");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("rjj0")("4ebad676",s,!0,{})},Raas:function(e,t,i){"use strict";function s(e){i("Q8/9")}var a=i("vTza"),o=i("nlWS"),r=i("VU/8"),n=s,l=r(a.a,o.a,!1,n,"data-v-49d11016",null);t.a=l.exports},VXHo:function(e,t,i){t=e.exports=i("FZ+f")(!0),t.push([e.i,"#wechat .wechat-list .list-row .list-info .desc-box .desc-msg .desc-mute[data-v-49d11016]{display:none;float:right;color:#b8b8b8}","",{version:3,sources:["/Users/yunwisdom/Workspace/xdata-vuechat-service/src/components/wechat/msg-item.vue"],names:[],mappings:"AACA,0FACI,aAAc,AACd,YAAa,AACb,aAAe,CAClB",file:"msg-item.vue",sourcesContent:["\n#wechat .wechat-list .list-row .list-info .desc-box .desc-msg .desc-mute[data-v-49d11016] {\n    display: none;\n    float: right;\n    color: #b8b8b8;\n}\n"],sourceRoot:""}])},XZq4:function(e,t,i){"use strict";var s=i("Xxa5"),a=i.n(s),o=i("exGp"),r=i.n(o),n=i("A2Dw"),l=i("Raas");t.a={components:{search:n.default,msgItem:l.a},mixins:[window.mixin],data:function(){return{pageName:"消息",messages:[],timer:null,myuserinfo:null}},activated:function(){$("#return[tag=div]").remove(),this.changeStyle(),this.displayFoot(),this.userStatus(),this.queryInfo()},mounted:function(){this.changeStyle(),this.displayFoot(),this.userStatus(),this.queryInfo()},methods:{changeStyle:function(e){try{var e=window.location.hash.slice(2);e=e.includes("?")?e.split("?")[0]:e,e=e.includes("/")?e.split("/")[0]:e,$("#wx-nav dl").not("#wx-nav-"+e).removeClass("router-link-exact-active"),$("#wx-nav dl").not("#wx-nav-"+e).removeClass("router-link-active"),$("#wx-nav-"+e).addClass("router-link-exact-active"),$("#wx-nav-"+e).addClass("router-link-active"),console.log(e)}catch(e){console.log(e)}},displayFoot:function(){$(".app-footer").css("display","block")},clearLoginInfo:function(){var e=this;return r()(a.a.mark(function t(){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Betools.storage.getStore("system_linfo");case 3:i=t.sent,e.username=i.username,e.password=i.password,Betools.storage.clearStore("system_userinfo"),Betools.storage.clearStore("system_token"),Betools.storage.clearStore("system_department"),Betools.storage.clearStore("system_login_time"),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0);case 15:case"end":return t.stop()}},t,e,[[0,12]])}))()},queryInfo:function(){var e=this;return r()(a.a.mark(function t(){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.$store.state.msgList.baseMsg,t.next=3,Betools.storage.getStore("system_userinfo");case 3:return e.myuserinfo=t.sent,t.next=6,e.queryMessages();case 6:case"end":return t.stop()}},t,e)}))()},queryMessages:function(){var e=this;return r()(a.a.mark(function t(){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("/wechat"!=(i=e.$router.currentRoute.path)){t.next=14;break}return t.prev=2,t.next=5,Betools.query.queryVMessages(e.myuserinfo.userid,e.myuserinfo.username);case 5:e.messages=t.sent,e.messages.sort(function(e,t){return t.id-e.id}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.log(t.t0);case 12:window.wechatTimer&&clearTimeout(window.wechatTimer);try{window.wechatTimer=e.timeer=setTimeout(r()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.queryMessages();case 2:case"end":return t.stop()}},t,e)})),300)}catch(e){console.log(e)}case 14:case"end":return t.stop()}},t,e,[[2,9]])}))()},userStatus:function(){var e=this;return r()(a.a.mark(function t(){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Betools.storage.getStore("system_userinfo");case 3:if(i=t.sent,!Betools.tools.isNull(i)){t.next=9;break}return vant.Toast("尚未登录！"),t.next=8,e.clearLoginInfo();case 8:e.$router.push("/login");case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}},t,e,[[0,11]])}))()}}}},gxPA:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"wechat"}},[i("ul",{staticClass:"wechat-list"},e._l(e.messages,function(e){return i("msg-item",{key:e.mid,staticClass:"list-row line-bottom",attrs:{item:e}})}),1)])},a=[],o={render:s,staticRenderFns:a};t.a=o},nlWS:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{class:{"item-hide":e.deleteMsg}},[i("router-link",{directives:[{name:"swiper",rawName:"v-swiper"}],staticClass:"list-info",attrs:{to:{path:"/wechat/dialogue",query:{wxid:e.item.heuserid,mid:e.item.mid,name:e.item.group_name||e.item.user[0].remark||e.item.user[0].nickname,group_num:e.item.user.length}},tag:"div"},nativeOn:{click:function(t){return e.toggleMsgRead(t,"enter")}}},[i("div",{staticClass:"header-box"},[i("i",{directives:[{name:"show",rawName:"v-show",value:!e.read&&!e.item.quiet,expression:"!read&&!item.quiet"}],staticClass:"new-msg-count"},[e._v(e._s(e.item.msg.length))]),e._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:!e.read&&e.item.quiet,expression:"!read&&item.quiet"}],staticClass:"new-msg-dot"}),e._v(" "),i("div",{staticClass:"header",class:["group"==e.item.type?"multi-header":""]},e._l(e.item.user,function(e){return i("img",{key:e.avatar,attrs:{src:e.avatar}})}),0)]),e._v(" "),i("div",{staticClass:"desc-box"},[i("div",{staticClass:"desc-time"},[e._v(e._s(e._f("fmtDate")(e.item.msg[e.item.msg.length-1].date,"hh:ss")))]),e._v(" "),"group"==e.item.type?i("div",{staticClass:"desc-author"},[e._v(e._s(e.item.group_name))]):i("div",{staticClass:"desc-author"},[e._v(e._s(e.item.user[0].name))]),e._v(" "),i("div",{staticClass:"desc-msg"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.item.quiet,expression:"item.quiet"}],staticClass:"desc-mute iconfont icon-mute",staticStyle:{display:"none"}}),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:"group"==e.item.type,expression:"item.type=='group'"}]},[e._v(e._s(e.item.msg[e.item.msg.length-1].name)+":")]),e._v(" "),i("span",[e._v(e._s(e.item.msg[e.item.msg.length-1].text))])])])]),e._v(" "),i("div",{staticClass:"operate-box"},[e.read?i("div",{staticClass:"operate-unread",on:{click:e.toggleMsgRead}},[e._v("标为未读")]):i("div",{staticClass:"operate-read",on:{click:e.toggleMsgRead}},[e._v("标为已读")]),e._v(" "),i("div",{staticClass:"operate-del",on:{click:e.deleteMsgEvent}},[e._v("删除")])])],1)},a=[],o={render:s,staticRenderFns:a};t.a=o},oALz:function(e,t,i){"use strict";function s(e){i("vvau")}Object.defineProperty(t,"__esModule",{value:!0});var a=i("XZq4"),o=i("gxPA"),r=i("VU/8"),n=s,l=r(a.a,o.a,!1,n,"data-v-3b4695a2",null);t.default=l.exports},qUFw:function(e,t,i){t=e.exports=i("FZ+f")(!0),t.i(i("NsiS"),""),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"wechat.vue",sourceRoot:""}])},vTza:function(e,t,i){"use strict";t.a={props:["item"],data:function(){return{read:this.item.read,deleteMsg:!1}},methods:{toggleMsgRead:function(e,t){if("enter"===t){if(this.read)return"";this.read=!0}else this.read=!this.read;this.item.quiet||(this.read?this.$store.commit("minusNewMsg"):this.$store.commit("addNewMsg")),e.target.parentNode.parentNode.firstChild.style.marginLeft="0px"},deleteMsgEvent:function(){this.deleteMsg=!0,this.item.quiet||this.read||this.$store.commit("minusNewMsg")}},directives:{swiper:{bind:function(e,t){var i,s,a;e.addEventListener("touchstart",function(e){var t=e.touches[0];s=t.clientX,a=t.clientY,i=!1},!1),e.addEventListener("touchmove",function(t){var o=t.changedTouches[0],r=o.clientX,n=o.clientY,l=s-r,c=a-n;l<0?Math.abs(l)>=Math.abs(c)&&Math.abs(l)>20&&(e.style.transition="0.3s",e.style.marginLeft="0px"):Math.abs(l)>=Math.abs(c)&&l<156&&l>20&&(t.preventDefault(),e.style.transition="0s",e.style.marginLeft=-l+"px",i=!0)},!1),e.addEventListener("touchend",function(t){if(i){var o=t.changedTouches[0],r=o.clientX,n=o.clientY,l=s-r,c=a-n;if(Math.abs(l)>=Math.abs(c)){if(l<0)return;Math.abs(l)<60?(!0,e.style.transition="0.3s",e.style.marginLeft="0px"):(e.style.transition="0.3s",e.style.marginLeft="-156px")}}},!1)}}}}},vvau:function(e,t,i){var s=i("qUFw");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("rjj0")("a7149f44",s,!0,{})}});